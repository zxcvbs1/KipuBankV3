Compiling 58 files with Solc 0.8.24
Solc 0.8.24 finished in 13.12s
Compiler run successful with warnings:
Warning (2519): This declaration shadows an existing declaration.
  --> test/CheckAmmVsOracle.t.sol:13:51:
   |
13 |         try vm.envUint("ORACLE_DEV_BPS") returns (uint256 bps) {
   |                                                   ^^^^^^^^^^^
Note: The shadowed declaration is here:
  --> test/CheckAmmVsOracle.t.sol:48:9:
   |
48 |         uint256 bps = oracleOut == 0 ? 0 : (diff * 10_000) / oracleOut;
   |         ^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> test/KipuBankV3.t.sol:543:9:
    |
543 |         uint256 minOut = (expectedOut * (10_000 - SLIPPAGE_BPS)) / 10_000; // ~158.4e6
    |         ^^^^^^^^^^^^^^

Warning (2072): Unused local variable.
   --> test/KipuBankV3.t.sol:813:9:
    |
813 |         bytes32 adminRole = bank.DEFAULT_ADMIN_ROLE();
    |         ^^^^^^^^^^^^^^^^^

Warning (2018): Function state mutability can be restricted to view
   --> test/KipuBankV3.t.sol:155:5:
    |
155 |     function test_token_aceptado() public {
    |     ^ (Relevant source part starts here and spans across multiple lines).

Analysing contracts...
Running tests...

Ran 1 test for test/KipuTimelock.t.sol:KipuTimelockTest
[PASS] test_timelock_puede_actualizar_configs() (gas: 235167)
Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 3.42s (4.21ms CPU time)

Ran 1 test for test/CheckAmmVsOracle.t.sol:CheckAmmVsOracle
[PASS] test_amm_vs_oraculo_info() (gas: 61321)
Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 4.24s (4.23s CPU time)

Ran 5 tests for test/KipuBankV3Oracle.t.sol:KipuBankV3OracleTest
[PASS] test_eth_con_oraculo_ok_tolerancia_alta() (gas: 51755)
[PASS] test_eth_con_oraculo_revert_por_desviacion() (gas: 3972697)
[PASS] test_eth_oraculo_fallback_por_revert() (gas: 4146137)
[PASS] test_eth_sin_oraculo_ok() (gas: 4108591)
[PASS] test_gas_eth_sin_vs_con_oraculo() (gas: 51598)
Suite result: ok. 5 passed; 0 failed; 0 skipped; finished in 7.31s (4.29s CPU time)

Ran 34 tests for test/KipuBankV3.t.sol:KipuBankV3Test
[PASS] test_admin_setters_config() (gas: 127698)
[PASS] test_bank_cap_precheck_y_credito() (gas: 4133051)
[PASS] test_constructor_decimales_usdc_invalidos() (gas: 924734)
[PASS] test_constructor_parametros_invalidos() (gas: 479857)
[PASS] test_constructor_slippage_excesivo() (gas: 86152)
[PASS] test_depositar_erc20_cap_precheck_revert() (gas: 3949895)
[PASS] test_depositar_erc20_con_par_swapea_a_usdc() (gas: 304509)
[PASS] test_depositar_erc20_revert_cap_en_cierre() (gas: 3989530)
[PASS] test_depositar_erc20_revert_cap_en_cierre_sin_mocks() (gas: 4060205)
[PASS] test_depositar_eth_cap_precheck_revert() (gas: 3926668)
[PASS] test_depositar_eth_revert_cap_en_cierre() (gas: 4031239)
[PASS] test_depositar_eth_revert_pair_inexistente() (gas: 53035)
[PASS] test_depositar_eth_swapea_a_usdc() (gas: 265582)
[PASS] test_depositar_parametros_invalidos_erc20() (gas: 45149)
[PASS] test_depositar_parametros_invalidos_eth() (gas: 35752)
[PASS] test_depositar_recibe_eth_via_receive() (gas: 262986)
[PASS] test_depositar_revertir_sin_par_directo() (gas: 33838)
[PASS] test_depositar_usdc_directo() (gas: 191924)
[PASS] test_pausar_bloquea_ops_y_roles() (gas: 206676)
[PASS] test_receive_eth_monto_cero_revert() (gas: 21372)
[PASS] test_retirar_respeta_withdraw_cap() (gas: 306535)
[PASS] test_retirar_token_invalido_y_casos_borde() (gas: 59038)
[PASS] test_roles_admin_otorga_pauser_y_nuevo_pauser_puede_pausar() (gas: 64082)
[PASS] test_roles_no_admin_no_puede_otorgar_pauser() (gas: 40104)
[PASS] test_roles_no_pauser_no_puede_pausar_y_unpause() (gas: 45385)
[PASS] test_roles_pauser_sin_admin_no_puede_otorgar() (gas: 46548)
[PASS] test_slippage_erc20_custom_revert_por_minout() (gas: 168254)
[PASS] test_slippage_erc20_dentro_margen_ok() (gas: 294377)
[PASS] test_slippage_erc20_fuera_margen_revert() (gas: 165314)
[PASS] test_slippage_eth_custom_revert_por_minout() (gas: 3946941)
[PASS] test_slippage_eth_dentro_margen_ok() (gas: 268291)
[PASS] test_slippage_eth_fuera_margen_revert() (gas: 92617)
[PASS] test_token_aceptado() (gas: 34682)
[PASS] test_vistas_capacidad_y_contadores() (gas: 168218)
Suite result: ok. 34 passed; 0 failed; 0 skipped; finished in 7.31s (9.84s CPU time)

Ran 4 test suites in 7.31s (22.27s CPU time): 41 tests passed, 0 failed, 0 skipped (41 total tests)

╭----------------------------------+------------------+------------------+----------------+----------------╮
| File                             | % Lines          | % Statements     | % Branches     | % Funcs        |
+==========================================================================================================+
| script/DeployKipuBankV3.s.sol    | 0.00% (0/36)     | 0.00% (0/46)     | 0.00% (0/4)    | 0.00% (0/1)    |
|----------------------------------+------------------+------------------+----------------+----------------|
| script/DeployKipuTimelock.s.sol  | 0.00% (0/18)     | 0.00% (0/25)     | 100.00% (0/0)  | 0.00% (0/1)    |
|----------------------------------+------------------+------------------+----------------+----------------|
| script/SetOracleDevBpsZero.s.sol | 0.00% (0/12)     | 0.00% (0/15)     | 100.00% (0/0)  | 0.00% (0/1)    |
|----------------------------------+------------------+------------------+----------------+----------------|
| src/KipuBankV3.sol               | 79.15% (167/211) | 74.83% (223/298) | 60.71% (34/56) | 91.30% (21/23) |
|----------------------------------+------------------+------------------+----------------+----------------|
| test/mocks/MockERC20.sol         | 50.00% (4/8)     | 50.00% (2/4)     | 100.00% (0/0)  | 50.00% (2/4)   |
|----------------------------------+------------------+------------------+----------------+----------------|
| test/mocks/MockWETH9.sol         | 0.00% (0/9)      | 0.00% (0/8)      | 0.00% (0/4)    | 0.00% (0/2)    |
|----------------------------------+------------------+------------------+----------------+----------------|
| Total                            | 58.16% (171/294) | 56.82% (225/396) | 53.12% (34/64) | 71.88% (23/32) |
╰----------------------------------+------------------+------------------+----------------+----------------╯
